<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UB Liv'Link Admin Dashboard</title>
    <link rel="stylesheet" href="dashboard-styles.css"> 
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    
    <style>
        /* Specific style for the Chart Container */
        .chart-container {
            background-color: var(--surface-color);
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-subtle);
            margin-bottom: 30px;
        }

        /* Verification Status Styling */
        .pending-status { background-color: #fff3cd; color: #856404; font-weight: 700; }
        .action-btn.view-docs-btn { color: var(--primary-color); border-color: var(--primary-color); }
    </style>
</head>
<body class="admin-dashboard-override">
    <div class="dashboard-wrapper">
        
        <aside class="sidebar">
            <div class="logo-container">
                <img src="unnamed.png" alt="UB Liv'Link Logo">
                <div class="app-name">UB Housing Admin</div>
            </div>
            <nav class="nav-menu">
                <a href="#admin-overview" class="nav-item active">üè† Overview</a>
                <a href="#verification" class="nav-item" id="verification-nav">‚úÖ Verification Queue</a>
                <a href="#reports" class="nav-item">üìà Data & Reports</a>
                <a href="#moderation" class="nav-item">‚ö†Ô∏è Review Moderation</a>
                <a href="#system" class="nav-item">‚öôÔ∏è System Mgmt</a>
            </nav>
            <button class="add-listing-btn" onclick="openAdminLog()">View Audit Log</button>
        </aside>

        <main class="content-area">
            
            <div class="kpi-ticker">
                <div class="ticker-item">New Review: <strong>4.2/5</strong> (University Ave)</div>
                <div class="ticker-item">Listing Verified: <strong>LST345</strong> (Campus Heights)</div>
                <div class="ticker-item">System Load: <strong>12%</strong></div>
                <div class="ticker-item">Critical Flag: <strong>1 New</strong> (The Courtyard)</div>
            </div>
            
            <section id="admin-overview" class="module active">
                <h2>Admin Dashboard Overview</h2>
                
<div class="map-controls" style="margin-bottom: 15px;">
    <label for="map-data-layer" style="font-weight: 600; color: var(--text-color);">Map Data View:</label>
    <select id="map-data-layer" style="padding: 8px; border-radius: 6px; border: 1px solid #ddd; margin-left: 10px;">
        <option value="density">Property Density Heatmap</option>
        <option value="rating">Average Rating by Zone</option>
        <option value="complaints">Critical Complaint Hotspots</option>
    </select>
</div>
<div id="interactive-map-area" class="map-placeholder">
    Loading Map: Property Density Heatmap...
</div>
                
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <h3>Listings Pending Verification</h3>
                        <p class="stat-number">12</p>
                    </div>
                    <div class="stat-card accent">
                        <h3>Critical Reviews Flagged</h3>
                        <p class="stat-number">7</p>
                    </div>
                    <div class="stat-card primary">
                        <h3>User Account Reports</h3>
                        <p class="stat-number">3</p>
                    </div>
                    <div class="stat-card accent">
                        <h3>Total Landlord Registrations</h3>
                        <p class="stat-number">45</p>
                    </div>
                </div>
            </section>
            
            <section id="verification" class="module">
                <h2>‚úÖ Listing Verification Queue</h2>
                
                <p style="font-weight: 600; color: #555;">Today's Goal: <span id="verified-count">5</span> / <span id="total-pending">12</span> Listings Verified</p>
                <div class="progress-container">
                    <div id="progress-bar" class="progress-bar" style="width: 42%;"></div>
                </div>

                <div class="verification-table">
                    <div class="table-header">
                        <div>Property & Landlord</div>
                        <div>Date Submitted</div>
                        <div>Status</div>
                        <div>Documents</div>
                        <div>Actions</div>
                    </div>
                    
                    <div class="table-row" data-listing-id="LST101" id="row-LST101">
                        <div>The Courtyard, Unit 7 (John Smith)</div>
                        <div>2025-11-12</div>
                        <div class="status pending-status">PENDING</div>
                        <div><button class="action-btn view-docs-btn">View Docs</button></div>
                        <div>
                            <button class="verify-btn">Verify</button>
                            <button class="reject-btn">Reject</button>
                        </div>
                    </div>
                    
                    <div class="table-row" data-listing-id="LST102" id="row-LST102">
                        <div>Campus Heights Apt B (Jane Doe Prop.)</div>
                        <div>2025-11-09</div>
                        <div class="status pending-status">PENDING</div>
                        <div><button class="action-btn view-docs-btn">View Docs</button></div>
                        <div>
                            <button class="verify-btn">Verify</button>
                            <button class="reject-btn">Reject</button>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="reports" class="module">
                <h2>üìà Advanced Data & Reporting</h2>
                
                <div class="chart-container">
                    <h3 style="color:var(--primary-color); margin-top:0;">Listing Conversion Rate: Q3 2025</h3>
                    <canvas id="conversion-chart"></canvas>
                </div>
                
                <div class="report-section">
                    
                    <div class="report-card">
                        <h4>Strategic Market Report</h4>
                        <form>
                            <label for="report-type">Metric:</label>
                            <select id="report-type">
                                <option>View-to-Contact Conversion</option>
                                <option>Average Rent by Zone</option>
                            </select>
                            <label for="date-range">Date Range:</label>
                            <input type="text" id="date-range" value="Last 90 Days" placeholder="Last 90 Days">
                            <button type="submit" class="primary-btn">Generate Analytics</button>
                        </form>
                    </div>

                    <div class="report-card">
                        <h4>Compliance & Audit Log</h4>
                        <form>
                            <label for="admin-user">Admin User:</label>
                            <select id="admin-user">
                                <option>All Staff</option>
                                <option>Admin ID 1001 (Sarah)</option>
                            </select>
                            <label for="action-type">Action Type:</label>
                            <select id="action-type">
                                <option>Listing Verification</option>
                                <option>User Ban/Suspend</option>
                            </select>
                            <button type="submit" class="primary-btn">Pull Audit Data</button>
                        </form>
                    </div>
                    
                </div>
            </section>
            
            <section id="moderation" class="module">
                <h2>‚ö†Ô∏è Critical Review Moderation</h2>
                <div class="settings-card">
                    <h3 style="color:#dc3545;">AI-Flagged Critical Reviews (7 Pending)</h3>
                    <form>
                        <label for="ai-flag">Filter by Critical Flag:</label>
                        <select id="ai-flag">
                            <option>High Severity (Safety/Legal risk)</option>
                            <option>Maintenance Issue Frequency</option>
                        </select>
                        <button type="submit" class="primary-btn" style="background-color:#dc3545;">Search & Prioritize</button>
                    </form>
                </div>
                
                <div class="review-list" style="margin-top: 20px;">
                    <div class="review-card" style="border-left: 4px solid #dc3545;">
                        <p class="review-meta" style="color:#dc3545; font-weight:700;">HIGH SEVERITY FLAG | Listing: The Courtyard</p>
                        <p class="review-text">"Our heating went out last week and the landlord hasn't responded to the emergency request in 48 hours. This is unsafe."</p>
                        <p class="review-author">‚Äî Student ID 543</p>
                        <button class="action-btn reject-btn" style="background-color:#dc3545; color:white;">Investigate Property</button>
                    </div>
                </div>
            </section>

            <section id="system" class="module">
                <h2>‚öôÔ∏è System Management</h2>
                <p>Manage global system parameters and platform integration settings.</p>
                <div class="settings-card">
                    <h3>API Integration & Keys</h3>
                    <form>
                        <label for="api-key">External Service API Key:</label>
                        <input type="text" id="api-key" value="ASDFG-HJKL-2345-QWERT" required>
                        <button type="submit" class="primary-btn">Update API Key</button>
                    </form>
                </div>
            </section>
            
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navItems = document.querySelectorAll('.nav-item');
            const modules = document.querySelectorAll('.module');
            const totalPendingElement = document.getElementById('total-pending');
            const verifiedCountElement = document.getElementById('verified-count');
            const progressBar = document.getElementById('progress-bar');
            
            let verifiedCount = 5;
            const totalPending = 12;

            function switchModule(targetId, navElement) {
                navItems.forEach(nav => nav.classList.remove('active'));
                if (navElement) {
                    navElement.classList.add('active');
                }
                modules.forEach(mod => mod.classList.remove('active'));
                const targetModule = document.getElementById(targetId);
                if (targetModule) {
                    targetModule.classList.add('active');
                }
            }
            
            function updateProgressBar() {
                const percentage = (verifiedCount / totalPending) * 100;
                progressBar.style.width = `${percentage}%`;
                verifiedCountElement.textContent = verifiedCount;
            }

            function handleVerificationAction(e, action) {
                e.preventDefault();
                const listingRow = e.target.closest('.table-row');
                const listingId = listingRow.dataset.listingId;
                const statusElement = listingRow.querySelector('.status');
                
                if (statusElement.textContent.trim() !== 'PENDING') {
                    alert(`Listing ${listingId} is already ${statusElement.textContent.trim()}.`);
                    return;
                }

                listingRow.style.opacity = 0.5;
                
                setTimeout(() => {
                    if (action === 'verify') {
                        statusElement.textContent = 'VERIFIED';
                        statusElement.className = 'status';
                        statusElement.style.backgroundColor = '#d4edda';
                        statusElement.style.color = '#155724';
                        
                        verifiedCount++;
                        updateProgressBar();
                        alert(`Listing ${listingId} verified!`);

                    } else if (action === 'reject') {
                        statusElement.textContent = 'REJECTED';
                        statusElement.className = 'status';
                        statusElement.style.backgroundColor = '#f8d7da';
                        statusElement.style.color = '#721c24';
                        alert(`Listing ${listingId} rejected.`);
                    }
                    
                    listingRow.style.opacity = 1;
                    listingRow.querySelectorAll('.verify-btn, .reject-btn').forEach(btn => btn.disabled = true);
                }, 800);
            }

            // --- FANCY JS FEATURE 3: Interactive Map Simulation ---
    const mapArea = document.getElementById('interactive-map-area');
    const mapLayerSelect = document.getElementById('map-data-layer');
    const mapViews = {
        density: "Property Density Heatmap (Most Listings)",
        rating: "Average Rating by Zone (Rating > 4.0)",
        complaints: "Critical Complaint Hotspots (High Severity)",
    };

    mapLayerSelect.addEventListener('change', (e) => {
        const selectedKey = e.target.value;
        mapArea.classList.add('loading'); // Use CSS transition for visual effect
        mapArea.textContent = `Rendering Map: ${mapViews[selectedKey]}...`;

        // Simulate data fetching and rendering delay
        setTimeout(() => {
            mapArea.classList.remove('loading');
            mapArea.innerHTML = `
                <p style="font-size: 1.1em;">
                     **${mapViews[selectedKey]}** is now displayed. 
                    (Data filtered by ${selectedKey.toUpperCase()})
                </p>
                <p style="font-size: 0.8em; color: #6c757d;">
                    (In a real app, this would integrate with Google Maps or Leaflet.)
                </p>
            `;
        }, 1000); // 1 second delay for realism
    });

            // Event Listeners for Dynamic Actions
            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = e.currentTarget.getAttribute('href').substring(1);
                    switchModule(targetId, e.currentTarget);
                });
            });
            
            document.querySelectorAll('.verify-btn').forEach(btn => {
                btn.addEventListener('click', (e) => handleVerificationAction(e, 'verify'));
            });

            document.querySelectorAll('.reject-btn').forEach(btn => {
                btn.addEventListener('click', (e) => handleVerificationAction(e, 'reject'));
            });

            // --- FANCY JS FEATURE 2: Chart.js Data Visualization (Now uses Purple) ---
            const ctx = document.getElementById('conversion-chart');
            if (ctx) {
                 new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Sept', 'Oct', 'Nov', 'Dec'],
                        datasets: [{
                            label: 'Conversion Rate % (Views to Contact)',
                            data: [3.5, 3.8, 4.2, 4.0],
                            // Using RGB for #5D2D91
                            borderColor: 'rgb(93, 45, 145)', 
                            backgroundColor: 'rgba(93, 45, 145, 0.1)',
                            fill: true,
                            tension: 0.3,
                            borderWidth: 3,
                            pointRadius: 5
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: false,
                                title: {
                                    display: true,
                                    text: 'Conversion Rate (%)'
                                }
                            }
                        }
                    }
                });
            }

            updateProgressBar();
            
            window.openAdminLog = function() {
                alert("Opening the System Audit Log (conceptual)...");
            };
            document.querySelectorAll('.report-card form').forEach(form => {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    alert(`Report generated! Parameters: ${new FormData(form).get('report-type') || new FormData(form).get('ai-flag')}`);
                });
            });
        });
    </script>
</body>
</html> map placeholder