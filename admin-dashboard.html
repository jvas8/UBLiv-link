<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UB Liv'Link Admin Dashboard</title>
    <link rel="stylesheet" href="styles.css"> 
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="uba-dashboard">
    <div class="uba-wrapper">
        
        <aside class="uba-sidebar">
            <div class="uba-logo-container">
                <img src="unnamed.png" alt="UB Liv'Link Logo">
                <div class="uba-app-name">UB Housing Admin</div>
            </div>
            <nav class="uba-nav-menu">
                <a href="#uba-overview" class="uba-nav-item active">üè† Overview</a>
                <a href="#uba-verification-queue" class="uba-nav-item">‚úÖ Verification Queue</a>
                <a href="#uba-verification-report" class="uba-nav-item">üìä Verification Report</a>
                <a href="#uba-review-report" class="uba-nav-item">‚ö†Ô∏è Review Report</a>
            </nav>
            <button class="uba-audit-btn" onclick="openAdminLog()">View Audit Log</button>
        </aside>

        <main class="uba-content-area">
            
            <section id="uba-overview" class="uba-module active">
                <h2>Admin Dashboard Overview</h2>
                
                <div class="uba-stats-grid">
                    <div class="uba-stat-card primary">
                        <h3>Listings Pending Verification</h3>
                        <p class="uba-stat-number">12</p>
                    </div>
                    <div class="uba-stat-card accent">
                        <h3>Total Active Listings</h3>
                        <p class="uba-stat-number">103</p>
                    </div>
                    <div class="uba-stat-card primary">
                        <h3>Total Landlord Registrations</h3>
                        <p class="uba-stat-number">45</p>
                    </div>
                    <div class="uba-stat-card accent">
                        <h3>Critical Reviews Flagged</h3>
                        <p class="uba-stat-number">7</p>
                    </div>
                </div>
            </section>
            
            <section id="uba-verification-queue" class="uba-module">
                <h2>‚úÖ Listing Verification Queue</h2>
                
                <p style="font-weight: 600; color: #555;">Today's Goal: <span id="verified-count">5</span> / <span id="total-pending">12</span> Listings Verified</p>
                <div class="uba-progress-container">
                    <div id="uba-progress-bar" class="uba-progress-bar" style="width: 42%;"></div>
                </div>

                <div class="uba-verification-table">
                    <div class="uba-table-header">
                        <div>Property & Landlord</div>
                        <div>Date Submitted</div>
                        <div>Status</div>
                        <div>Documents</div>
                        <div>Actions</div>
                    </div>
                    
                    <div class="uba-table-row" data-listing-id="LST101" id="row-LST101">
                        <div>The Courtyard, Unit 7 (John Smith)</div>
                        <div>2025-11-12</div>
                        <div class="uba-status uba-status-pending">PENDING</div>
                        <div><button class="uba-action-btn uba-view-docs-btn">View Docs</button></div>
                        <div>
                            <button class="uba-verify-btn">Verify</button>
                            <button class="uba-reject-btn">Reject</button>
                        </div>
                    </div>
                    
                    <div class="uba-table-row" data-listing-id="LST102" id="row-LST102">
                        <div>Campus Heights Apt B (Jane Doe Prop.)</div>
                        <div>2025-11-09</div>
                        <div class="uba-status uba-status-pending">PENDING</div>
                        <div><button class="uba-action-btn uba-view-docs-btn">View Docs</button></div>
                        <div>
                            <button class="uba-verify-btn">Verify</button>
                            <button class="uba-reject-btn">Reject</button>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="uba-verification-report" class="uba-module">
                <h2>üìä Verification Report: Q3 Performance</h2>
                
                <div class="uba-chart-container">
                    <h3 style="color:var(--primary-color); margin-top:0;">Verification Rate: Q3 2025</h3>
                    <canvas id="conversion-chart"></canvas>
                </div>
                
                <div class="uba-report-section">
                    
                    <div class="uba-report-card">
                        <h4>Verification Compliance Overview</h4>
                        <form>
                            <label for="report-type">Metric:</label>
                            <select id="report-type">
                                <option>Average Time to Verify (Days)</option>
                                <option>Rejection Rate by Document Type</option>
                            </select>
                            <label for="date-range">Date Range:</label>
                            <input type="text" id="date-range" value="Last 90 Days" placeholder="Last 90 Days">
                            <button type="submit" class="uba-primary-btn">Generate Analytics</button>
                        </form>
                    </div>
                </div>
            </section>
            
            <section id="uba-review-report" class="uba-module">
                <h2>‚ö†Ô∏è Review Moderation Report</h2>
                <div class="uba-settings-card">
                    <h3 style="color:#dc3545;">AI-Flagged Critical Reviews (7 Pending)</h3>
                    <form>
                        <label for="ai-flag">Filter by Critical Flag:</label>
                        <select id="ai-flag">
                            <option>High Severity (Safety/Legal risk)</option>
                            <option>Maintenance Issue Frequency</option>
                            <option>Moderator Action History</option>
                        </select>
                        <button type="submit" class="uba-primary-btn" style="background-color:#dc3545;">Search & Prioritize</button>
                    </form>
                </div>
                
                <div class="uba-review-list" style="margin-top: 20px;">
                    <div class="uba-review-card" style="border-left: 4px solid #dc3545;">
                        <p class="uba-review-meta" style="color:#dc3545; font-weight:700;">HIGH SEVERITY FLAG | Listing: The Courtyard</p>
                        <p class="uba-review-text">"Our heating went out last week and the landlord hasn't responded to the emergency request in 48 hours. This is unsafe."</p>
                        <p class="uba-review-author">‚Äî Student ID 543</p>
                        <button class="uba-action-btn uba-reject-btn" style="background-color:#dc3545; color:white;">Investigate Property</button>
                    </div>
                </div>
            </section>
            
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navItems = document.querySelectorAll('.uba-nav-item');
            const modules = document.querySelectorAll('.uba-module');
            const totalPendingElement = document.getElementById('total-pending');
            const verifiedCountElement = document.getElementById('verified-count');
            const progressBar = document.getElementById('uba-progress-bar');
            
            let verifiedCount = 5;
            const totalPending = 12;

            function switchModule(targetId, navElement) {
                navItems.forEach(nav => nav.classList.remove('active'));
                if (navElement) {
                    navElement.classList.add('active');
                }
                modules.forEach(mod => mod.classList.remove('active'));
                const targetModule = document.getElementById(targetId);
                if (targetModule) {
                    targetModule.classList.add('active');
                }
            }
            
            function updateProgressBar() {
                const percentage = (verifiedCount / totalPending) * 100;
                progressBar.style.width = `${percentage}%`;
                verifiedCountElement.textContent = verifiedCount;
            }

            function handleVerificationAction(e, action) {
                e.preventDefault();
                const listingRow = e.target.closest('.uba-table-row');
                const listingId = listingRow.dataset.listingId;
                const statusElement = listingRow.querySelector('.uba-status');
                
                if (statusElement.textContent.trim() !== 'PENDING') {
                    alert(`Listing ${listingId} is already ${statusElement.textContent.trim()}.`);
                    return;
                }

                listingRow.style.opacity = 0.5;
                
                setTimeout(() => {
                    if (action === 'verify') {
                        statusElement.textContent = 'VERIFIED';
                        statusElement.className = 'uba-status';
                        statusElement.style.backgroundColor = '#d4edda';
                        statusElement.style.color = '#155724';
                        
                        verifiedCount++;
                        updateProgressBar();
                        alert(`Listing ${listingId} verified!`);

                    } else if (action === 'reject') {
                        statusElement.textContent = 'REJECTED';
                        statusElement.className = 'uba-status';
                        statusElement.style.backgroundColor = '#f8d7da';
                        statusElement.style.color = '#721c24';
                        alert(`Listing ${listingId} rejected.`);
                    }
                    
                    listingRow.style.opacity = 1;
                    listingRow.querySelectorAll('.uba-verify-btn, .uba-reject-btn').forEach(btn => btn.disabled = true);
                }, 800);
            }

            // Event Listeners for Dynamic Actions
            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = e.currentTarget.getAttribute('href').substring(1);
                    switchModule(targetId, e.currentTarget);
                });
            });
            
            document.querySelectorAll('.uba-verify-btn').forEach(btn => {
                btn.addEventListener('click', (e) => handleVerificationAction(e, 'verify'));
            });

            document.querySelectorAll('.uba-reject-btn').forEach(btn => {
                btn.addEventListener('click', (e) => handleVerificationAction(e, 'reject'));
            });

            // Chart.js Data Visualization
            const ctx = document.getElementById('conversion-chart');
            if (ctx) {
                 new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Sept', 'Oct', 'Nov', 'Dec'],
                        datasets: [{
                            label: 'Conversion Rate % (Views to Contact)',
                            data: [3.5, 3.8, 4.2, 4.0],
                            // Using RGB for #5D2D91 (primary-color)
                            borderColor: 'rgb(93, 45, 145)', 
                            backgroundColor: 'rgba(93, 45, 145, 0.1)',
                            fill: true,
                            tension: 0.3,
                            borderWidth: 3,
                            pointRadius: 5
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: false,
                                title: {
                                    display: true,
                                    text: 'Verification Rate (%)'
                                }
                            }
                        }
                    }
                });
            }

            updateProgressBar();
            
            window.openAdminLog = function() {
                alert("Opening the System Audit Log (conceptual)...");
            };
            document.querySelectorAll('.uba-report-card form, .uba-settings-card form').forEach(form => {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    alert(`Report generated! Parameters: ${new FormData(form).get('report-type') || new FormData(form).get('ai-flag')}`);
                });
            });

            // Initial switch to overview
            switchModule('uba-overview', document.querySelector('[href="#uba-overview"]'));
        });
    </script>
</body>
</html>